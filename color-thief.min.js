/*!
 * Color Thief v2.0
 * by Lokesh Dhakar - http://www.lokeshdhakar.com
 *
 * Thanks
 * ------
 * Nick Rabinowitz - For creating quantize.js.
 * John Schulz - For clean up and optimization. @JFSIII
 * Nathan Spady - For adding drag and drop support to the demo page.
 *
 * License
 * -------
 * Copyright 2011, 2015 Lokesh Dhakar
 * Released under the MIT license
 * https://raw.githubusercontent.com/lokesh/color-thief/master/LICENSE
 *
 */
;var CanvasImage=function(a){this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");document.body.appendChild(this.canvas);this.width=this.canvas.width=a.width;this.height=this.canvas.height=a.height;this.context.drawImage(a,0,0,this.width,this.height)};CanvasImage.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)};CanvasImage.prototype.update=function(a){this.context.putImageData(a,0,0)};CanvasImage.prototype.getPixelCount=function(){return this.width*this.height};CanvasImage.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};CanvasImage.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var ColorThief=function(){};ColorThief.prototype.getColor=function(c,d){var b=this.getPalette(c,5,d);var a=b[0];return a};ColorThief.prototype.getPalette=function(m,t,u){if(typeof t==="undefined"){t=10}if(typeof u==="undefined"||u<1){u=10}var l=new CanvasImage(m);var d=l.getImageData();var k=d.data;var e=l.getPixelCount();var f=[];for(var o=0,n,c,p,q,s;o<e;o=o+u){n=o*4;c=k[n+0];p=k[n+1];q=k[n+2];s=k[n+3];if(s>=125){if(!(c>250&&p>250&&q>250)){f.push([c,p,q])}}}var j=MMCQ.quantize(f,t);var h=j?j.palette():null;l.removeCanvas();return h};
/*!
 * quantize.js Copyright 2008 Nick Rabinowitz.
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 */
;
/*!
 * Block below copied from Protovis: http://mbostock.github.com/protovis/
 * Copyright 2010 Stanford Visualization Group
 * Licensed under the BSD License: http://www.opensource.org/licenses/bsd-license.php
 */
;if(!pv){var pv={map:function(c,a){var b={};return a?c.map(function(f,e){b.index=e;return a.call(b,f)}):c.slice()},naturalOrder:function(d,c){return(d<c)?-1:((d>c)?1:0)},sum:function(c,a){var b={};return c.reduce(a?function(f,g,e){b.index=e;return f+a.call(b,g)}:function(e,f){return e+f},0)},max:function(b,a){return Math.max.apply(null,a?pv.map(b,a):b)}}}var MMCQ=(function(){var e=5,c=8-e,h=1000,l=0.75;function d(o,n,m){return(o<<(2*e))+(n<<e)+m}function i(m){var p=[],n=false;function o(){p.sort(m);n=true}return{push:function(q){p.push(q);n=false},peek:function(q){if(!n){o()}if(q===undefined){q=p.length-1}return p[q]},pop:function(){if(!n){o()}return p.pop()},size:function(){return p.length},map:function(q){return p.map(q)},debug:function(){if(!n){o()}return p}}}function a(r,n,q,m,s,p,o){var t=this;t.r1=r;t.r2=n;t.g1=q;t.g2=m;t.b1=s;t.b2=p;t.histo=o}a.prototype={volume:function(n){var m=this;if(!m._volume||n){m._volume=((m.r2-m.r1+1)*(m.g2-m.g1+1)*(m.b2-m.b1+1))}return m._volume},count:function(s){var r=this,n=r.histo;if(!r._count_set||s){var q=0,p,o,m;for(p=r.r1;p<=r.r2;p++){for(o=r.g1;o<=r.g2;o++){for(m=r.b1;m<=r.b2;m++){index=d(p,o,m);q+=(n[index]||0)}}}r._count=q;r._count_set=true}return r._count},copy:function(){var m=this;return new a(m.r1,m.r2,m.g1,m.g2,m.b1,m.b2,m.histo)},avg:function(n){var t=this,r=t.histo;if(!t._avg||n){var w=0,q=1<<(8-e),v=0,u=0,y=0,m,s,p,o,x;for(s=t.r1;s<=t.r2;s++){for(p=t.g1;p<=t.g2;p++){for(o=t.b1;o<=t.b2;o++){x=d(s,p,o);m=r[x]||0;w+=m;v+=(m*(s+0.5)*q);u+=(m*(p+0.5)*q);y+=(m*(o+0.5)*q)}}}if(w){t._avg=[~~(v/w),~~(u/w),~~(y/w)]}else{t._avg=[~~(q*(t.r1+t.r2+1)/2),~~(q*(t.g1+t.g2+1)/2),~~(q*(t.b1+t.b2+1)/2)]}}return t._avg},contains:function(m){var n=this,o=m[0]>>c;gval=m[1]>>c;bval=m[2]>>c;return(o>=n.r1&&o<=n.r2&&gval>=n.g1&&gval<=n.g2&&bval>=n.b1&&bval<=n.b2)}};function g(){this.vboxes=new i(function(n,m){return pv.naturalOrder(n.vbox.count()*n.vbox.volume(),m.vbox.count()*m.vbox.volume())})}g.prototype={push:function(m){this.vboxes.push({vbox:m,color:m.avg()})},palette:function(){return this.vboxes.map(function(m){return m.color})},size:function(){return this.vboxes.size()},map:function(m){var o=this.vboxes;for(var n=0;n<o.size();n++){if(o.peek(n).vbox.contains(m)){return o.peek(n).color}}return this.nearest(m)},nearest:function(m){var r=this.vboxes,p,o,q;for(var n=0;n<r.size();n++){o=Math.sqrt(Math.pow(m[0]-r.peek(n).color[0],2)+Math.pow(m[1]-r.peek(n).color[1],2)+Math.pow(m[2]-r.peek(n).color[2],2));if(o<p||p===undefined){p=o;q=r.peek(n).color}}return q},forcebw:function(){var p=this.vboxes;p.sort(function(r,q){return pv.naturalOrder(pv.sum(r.color),pv.sum(q.color))});var n=p[0].color;if(n[0]<5&&n[1]<5&&n[2]<5){p[0].color=[0,0,0]}var m=p.length-1,o=p[m].color;if(o[0]>251&&o[1]>251&&o[2]>251){p[m].color=[255,255,255]}}};function k(s){var m=1<<(3*e),o=new Array(m),p,r,q,n;s.forEach(function(t){r=t[0]>>c;q=t[1]>>c;n=t[2]>>c;p=d(r,q,n);o[p]=(o[p]||0)+1});return o}function j(n,p){var t=1000000,w=0,r=1000000,v=0,u=1000000,m=0,q,o,s;n.forEach(function(x){q=x[0]>>c;o=x[1]>>c;s=x[2]>>c;if(q<t){t=q}else{if(q>w){w=q}}if(o<r){r=o}else{if(o>v){v=o}}if(s<u){u=s}else{if(s>m){m=s}}});return new a(t,w,r,v,u,m,p)}function f(q,v){if(!v.count()){return}var n=v.r2-v.r1+1,A=v.g2-v.g1+1,w=v.b2-v.b1+1,x=pv.max([n,A,w]);if(v.count()==1){return[v.copy()]}var z=0,y=[],s=[],r,p,o,u,t;if(x==n){for(r=v.r1;r<=v.r2;r++){u=0;for(p=v.g1;p<=v.g2;p++){for(o=v.b1;o<=v.b2;o++){t=d(r,p,o);u+=(q[t]||0)}}z+=u;y[r]=z}}else{if(x==A){for(r=v.g1;r<=v.g2;r++){u=0;for(p=v.r1;p<=v.r2;p++){for(o=v.b1;o<=v.b2;o++){t=d(p,r,o);u+=(q[t]||0)}}z+=u;y[r]=z}}else{for(r=v.b1;r<=v.b2;r++){u=0;for(p=v.r1;p<=v.r2;p++){for(o=v.g1;o<=v.g2;o++){t=d(p,o,r);u+=(q[t]||0)}}z+=u;y[r]=z}}}y.forEach(function(C,B){s[B]=z-C});function m(D){var I=D+"1",H=D+"2",C,J,F,E,B,G=0;for(r=v[I];r<=v[H];r++){if(y[r]>z/2){F=v.copy();E=v.copy();C=r-v[I];J=v[H]-r;if(C<=J){B=Math.min(v[H]-1,~~(r+J/2))}else{B=Math.max(v[I],~~(r-1-C/2))}while(!y[B]){B++}G=s[B];while(!G&&y[B-1]){G=s[--B]}F[H]=B;E[I]=F[H]+1;return[F,E]}}}return x==n?m("r"):x==A?m("g"):m("b")}function b(o,s){if(!o.length||s<2||s>256){return false}var p=k(o),q=1<<(3*e);var v=0;p.forEach(function(){v++});if(v<=s){}var r=j(o,p),m=new i(function(x,w){return pv.naturalOrder(x.count(),w.count())});m.push(r);function t(w,C){var y=1,x=0,z;while(x<h){z=w.pop();if(!z.count()){w.push(z);x++;continue}var D=f(p,z),B=D[0],A=D[1];if(!B){return}w.push(B);if(A){w.push(A);y++}if(y>=C){return}if(x++>h){return}}}t(m,l*s);var u=new i(function(x,w){return pv.naturalOrder(x.count()*x.volume(),w.count()*w.volume())});while(m.size()){u.push(m.pop())}t(u,s-u.size());var n=new g();while(u.size()){n.push(u.pop())}return n}return{quantize:b}})();